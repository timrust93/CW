@page
@model TemplateManagementModel
@using authHelpers = Forms.AuthorizationHelpers; 
@{
    var questionsJson = System.Text.Json.JsonSerializer.Serialize(Model.QuestionList);
    var questionTypesJson = System.Text.Json.JsonSerializer.Serialize(Model.QuestionTypeInfos);
    string changeOrderLink = $"TemplateManagement?handler=ChangeOrder&id={Model.TemplateId}";
    string saveQuestionLink = $"TemplateManagement?handler=SaveQuestion&id={Model.TemplateId}";
    string deleteQuestionLink = $"TemplateManagement?handler=DeleteQuestion&id={Model.TemplateId}";
    string antiForgeryKey = authHelpers.AuthHelper.ANTI_FORGERY;
}

<div>    
    Here you manage template
</div>

<ul id="sortable">    
</ul>

<a class="btn btn-primary" id="CreateQButton" asp-page="CreateQuestion" asp-route-id="@Model.Template.Id">Create new</a>





<template id="questionTemplate">
    <li>
        <form method="POST">
            <div>
                <label>Question Type</label>
                <div>
                    <select class="form-select"  data=""
                            data-val="true" data-val-required="The Question Type field is required.">
                        <option value="" disabled="" selected="">Please pick one</option>
                        <option value="0">Single Line</option>
                        <option value="1">Multi Line</option>
                        <option value="2">Number</option>
                        <option value="3">Checkbox</option>
                    </select>
                    <div>
                        <span class="text-danger templateValidation" data-valmsg-replace="true"></span>
                    </div>                                           
                    
                </div>           
                @* <input type="text" class="form-control" value="xx" /> *@
                <label>Title:</label>
                <input type="text" class="form-control"
                       data-name="Title"
                       data-val="true" data-val-required="The Title field is required." />
                <span class="text-danger templateValidation" data-valmsg-replace="true"></span>
            </div>
            <div>
                <label>Description:</label>
                <textarea type="text" class="form-control"
                       data-name="Description"/>
                </textarea>
            </div>
            <div>
                <button type="button" data="" onclick="onSaveQuestion(this)">Save</button>
                <button type="button" data="" onclick="onDeleteQuestion(this)">Delete</button>
            </div>
        </form>
    </li>
</template>

<input type="text" disabled="true" class="form-control" value="xx" />

@section Scripts
{
    <partial name="_ValidationScriptsPartial" />
    <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.min.js"></script>

    <script src="/js/questionManagement.js"></script>

    <script>
        var initialQuestions = @Html.Raw(questionsJson);
        var questionTypes = @Html.Raw(questionTypesJson);
        var maxQuestionCount = @Html.Raw(Model.MaxQuestionCount);
        var changeOrderLink = "@Html.Raw(changeOrderLink)";
        var deleteQuestionLink = "@Html.Raw(deleteQuestionLink)";
        var saveQuestionLink = "@Html.Raw(saveQuestionLink)";
        var antiForgeryKey = "@Html.Raw(antiForgeryKey)";

        $(document).ready(function () {
            initializeQuestionManagement();
        });
    </script>
}


<style>
    ul#sortable {
    list-style-type: none; /* Removes the dots */
    margin: 0;
    padding: 0;
    }

    .ui-selectmenu-menu {
        z-index: 1055 !important; /* Bootstrap modal has z-index: 1050 */
    }

    ul#sortable li {
    margin: 5px;
    padding: 10px; /* Space inside the li */
    border: 1px solid black; /* Add a border to make items clear */
    background-color: #f9f9f9;
    cursor: grab; /* Change cursor to indicate draggable */
    }

    ul#sortable li:active {
    cursor: grabbing;
    }

    ul#sortable li div {
    }
</style>